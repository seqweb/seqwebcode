#!/bin/bash
# *** This file is auto-generated by the SeqWeb bootstrap process ***

# Universal SeqWeb CLI Entry Point 
# This script reads seqweb.conf then delegates to the actual SeqWeb CLI implementation

set -e

# Source the configuration
if [ -f "$SEQWEBDEV_HOME/seqweb.conf" ]; then
    # Simple config parsing to get seqwebcode path
    SEQWEBCODE_PATH=$(awk -F'=' '/^[[:space:]]*seqwebcode[[:space:]]*=/ {gsub(/^[[:space:]]*"/, "", $2); gsub(/".*$/, "", $2); print $2}' "$SEQWEBDEV_HOME/seqweb.conf")
    # Construct the path to the implementation entry point
    SEQWEBDEV_ENTRYPOINT="$SEQWEBCODE_PATH/src/python/app/cli/seqwebdev"
    
    if [ -n "$SEQWEBCODE_PATH" ] && [ -f "$SEQWEBDEV_ENTRYPOINT" ]; then
        # Ensure the target CLI implementation is executable
        chmod +x "$SEQWEBDEV_ENTRYPOINT"
        # Call the actual CLI implementation with all arguments
        exec "$SEQWEBDEV_ENTRYPOINT" "$@"
    else
        echo "Error: Could not find seqweb SeqWeb CLI implementation at $SEQWEBDEV_ENTRYPOINT"
        echo "Please ensure seqwebcode repository is cloned and configured correctly"
        echo "See https://www.seqweb.org/quickstart for guidance."
        exit 1
    fi
    else
        echo "Error: seqweb.conf not found in $SEQWEBDEV_HOME"
        echo "Please ensure bootstrap script has been run correctly"
        echo "See https://www.seqweb.org/quickstart for guidance."
        exit 1
fi
